{% extends "base.html" %}

{% block title %}Nueva Operaci√≥n{% endblock %}

{% block content %}
<h2>Compra, venta o intercambio</h2>

<form method="POST">
    <label for="from">De:</label>
    <select name="from" required>
        {% for moneda in monedas %}
        <option value="{{ moneda }}" {% if datos_formulario.from == moneda %}selected{% endif %}>{{ moneda }}</option>
        {% endfor %}
    </select>

    <label for="to">A:</label>
    <select name="to" required>
        {% for moneda in monedas %}
        <option value="{{ moneda }}" {% if datos_formulario.to == moneda %}selected{% endif %}>{{ moneda }}</option>
        {% endfor %}
    </select>

    <label for="cantidad">Cantidad:</label>
    <input type="number" name="cantidad" step="0.01" required
           value="{{ datos_formulario.cantidad or '' }}">

    <button type="submit" name="calcular">üßÆ Calcular</button>

    {% if resultado %}
    <article>
        <h3>Previsualizaci√≥n:</h3>
        <p>Con <strong>{{ resultado.cantidad_from }} {{ resultado.from }}</strong> obtendr√°s aproximadamente:</p>
        <p><strong>{{ resultado.cantidad_to }} {{ resultado.to }}</strong></p>
        <p>Precio unitario: 1 {{ resultado.from }} = {{ resultado.rate }} {{ resultado.to }}</p>

        <button type="submit" name="confirmar">‚úÖ Confirmar operaci√≥n</button>

        <!-- Campos ocultos para no perder los datos -->
        <input type="hidden" name="rate" value="{{ resultado.rate }}">
    </article>
    {% endif %}
</form>
{% endblock %}
